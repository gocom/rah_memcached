h1. rah_memcached

"Packagist":https://packagist.org/packages/rah/rah_memcached | "Issues":https://github.com/gocom/rah_memcached/issues | "Donate":https://rahforum.biz/donate/rah_memcached

A plugin for "Textpattern CMS":https://textpattern.com that stores parts of your templates in "Memcached":https://memcached.org/, a distributed in-memory key-value caching system.

h2. Install

Using "Composer":https://getcomposer.org:

bc. $ composer require rah/rah_memcached

h2. Basics

The plugin, rah_memcached, introduces a new container tag to Textpattern's arsenal. The tag stores the wrapped content, and "variables":https://docs.textpattern.com/tags/variable set within it, in Memcached's in-memory storage.

bc. <txp:rah_memcached>
    <txp:variable name="variable1" value="value" />
    <txp:article_custom limit="200">
        <txp:title />
    </txp:article_custom>
</txp:rah_memcached>

On subsequent calls the resulting output markup and variables will be loaded from memory, skipping template parsing and code execution, speeding up your site and alleviating database load.

h2. Requirements

* Textpattern 4.6.0 or newer.
* PHP 5.6.0 or newer.
* "Memcached":http://www.php.net/manual/en/book.memcached.php PHP extension.
* "libmemcached":http://libmemcached.org/ client library.
* "Memcached":http://memcached.org/ server.

h2. Install external dependencies

To use the plugin you will must install Memcached, libmemcached and the PHP Memcached extension.

h3. On Ubuntu and Debian

Using apt:

bc. $ apt install memcached php5-memcached

h3. On Mac OS

Using "Homebrew":https://brew.sh and "pecl":https://pecl.php.net/package/memcached:

bc. $ brew install pkg-config php libmemcached memcached
$ pecl install memcached

h2. Attributes

The tag is a container, @<txp:rah_memcached> ...contained statement... </txp:rah_memcached>@, and attributes for it follow.

*expires*
Time in seconds it takes to the stored item to expire and be refreshed. If zero (@0@), the cache is kept in memory until the cache is flushed or Memcached is restarted.
Default: @0@ Example: @expires="3600"@

*lastmod*
If enabled, the item is refreshed on content updates.
Default: @1@ Example: @lastmod="1"@

*name*
Sets a name, key, for the cached item. The name must consist of a namespace and a local name, separated by colon. This name is then used identify the item and fetch it from the storage. If a _name_ is not defined, its automatically created by hashing the given contained markup. Giving a name is more efficient and avoids any potential collisions. Namespace is mandatory to make sure you use prefixes that prevent collisions and spoofing attacks when you use user-defined HTTP request data to construct page specific cached markup blocks.
Default: _undefined_ Example: @name="namespace:key"@

h2. Configuration

Connected server can be configured through Memcached configuration, or by setting them in Textpattern's @config.php@:

bc. define('\RAH_MEMCACHED_HOST', 'localhost');
define('\RAH_MEMCACHED_PORT', 11211);

h2. Examples

h3. Basic usage: store navigation in memory

bc. <txp:rah_memcached name="site:section_nav">
    <txp:section_list wraptag="ul" break="li">
        <txp:section />
    </txp:section_list>
</txp:rah_memcached>

h3. Store variables in memory

bc.. <txp:rah_memcached>
    <txp:variable name="color" value="red" />
    <txp:variable name="size" value="small" />
</txp:rah_memcached>

Color: <txp:variable name="color" />
Size: <txp:variable name="size" />

h2. Changelog

h3. Version 0.2.0 - upcoming

* Register the tag.

h3. Version 0.1.0 - 2014/03/19

* Initial release.
